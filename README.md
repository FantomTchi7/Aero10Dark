Based off of work by vaporvance and ImSwordKing
