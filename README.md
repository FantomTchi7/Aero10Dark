Based on the work by vaporvance and ImSwordKing
